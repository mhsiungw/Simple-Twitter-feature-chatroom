(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2dc771ba"],{"0f53":function(t,e,s){"use strict";s("de96")},"52af":function(t,e,s){},9194:function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chat-room-container"},[s("UserSidebar",{staticClass:"sidebar-section"}),s("ChatRoomSection",{staticClass:"chat-room-section",attrs:{"text-objs":t.textObjs,"online-users":t.onlineUsers},on:{"after-sent-text":t.send}})],1)},r=[],i=s("1da1"),a=s("5530"),o=(s("96cf"),s("a004")),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chat-room-section"},[s("div",{staticClass:"online-users"},[s("div",{staticClass:"title"},[t._v(" 上線使用者"),s("span",{staticClass:"online-user-count"},[t._v("("+t._s(t.onlineUsers.length)+")")])]),s("div",{staticClass:"user-list"},t._l(t.onlineUsers,(function(e){return s("div",{key:e.id,staticClass:"user-item"},[s("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(e.User.avatar),alt:"avatar"}}),s("div",{staticClass:"name"},[t._v(t._s(e.User.name))]),s("div",{staticClass:"account"},[t._v("@"+t._s(e.User.account))])])})),0)]),s("div",{staticClass:"chat-room"},[s("div",{staticClass:"title"},[t._v("公開聊天室")]),s("div",{staticClass:"chat-display-section"},t._l(t.textObjs,(function(e){return s("div",{key:e.id,staticClass:"dialogue",class:e.User2Id===t.currentUser.id?"currentuser":"others"},[e.User2Id!==t.currentUser.id?s("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(e.User2.avatar),alt:"avatar"}}):t._e(),s("div",{staticClass:"desc"},[s("div",{staticClass:"input"},[t._v(t._s(e.message))]),s("div",{staticClass:"time"},[t._v(t._s(t._f("fromNow")(e.createdAt)))])])])})),0),s("form",{staticClass:"input-form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.afterSendText.apply(null,arguments)}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"input",attrs:{type:"text"},domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}}),s("button",{staticClass:"submit-button",attrs:{type:"submit"}},[t._v(">>")])])])])},u=[],l=s("4cce"),d=s("2708"),f=s("2f62"),h={props:{textObjs:{type:Array,required:!0,default:function(){return[]}},onlineUsers:{type:Array,required:!0}},data:function(){return{users:[],text:""}},computed:Object(a["a"])({},Object(f["b"])(["currentUser"])),mixins:[d["a"],d["b"]],created:function(){this.fetchUsers()},methods:{fetchUsers:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["a"].getTopUsers();case 2:s=e.sent,n=s.data,t.users=n;case 5:case"end":return e.stop()}}),e)})))()},afterSendText:function(){this.$emit("after-sent-text",this.text),this.text=""}}},m=h,v=(s("0f53"),s("2877")),p=Object(v["a"])(m,c,u,!1,null,"50607917",null),x=p.exports,b={components:{UserSidebar:o["a"],ChatRoomSection:x},data:function(){return{textObjs:this.historyTexts,onlineUsers:[],id:-1}},watch:{historyTexts:{immediate:!0,handler:function(){this.textObjs=this.historyTexts}}},computed:Object(a["a"])({},Object(f["b"])(["currentUser","historyTexts"])),created:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l["a"].getCurrentUser();case 2:s=e.sent,n=s.data,console.log(n),t.id=n.id,t.$socket.emit("getCurrentUserId",n.id);case 7:case"end":return e.stop()}}),e)})))()},methods:{send:function(t){""!=t&&this.$socket.emit("emit_method",{msg:t,userId:this.currentUser.id})}},beforeRouteLeave:function(t,e,s){console.log(t,e),this.$socket.emit("leave",this.id),s()},sockets:{connect:function(){console.log("socket connected")},disconnect:function(){console.log("socket disconnected")},error:function(){console.log("socket error")},historyTexts:function(t){this.historyTexts&&0!=this.historyTexts.length||this.$store.commit("SOCKET_fetchHistoryTexts",t)},onlineUsers:function(t){console.log("onlineusers",t),this.onlineUsers=t},single_thread:function(t){console.log("single_thread",t),this.textObjs.push(t[0])}}},g=b,C=(s("ffda"),Object(v["a"])(g,n,r,!1,null,"7a0c38fd",null));e["default"]=C.exports},de96:function(t,e,s){},ffda:function(t,e,s){"use strict";s("52af")}}]);
//# sourceMappingURL=chunk-2dc771ba.251f0914.js.map